const socket = io();
const msgInput = document.getElementById('myMessage');
const userInput = document.getElementById('username');
const sendBtn = document.getElementById('sendButton');

// Función para generar un color único basado en el nombre
function stringToColor(str) {
    let hash = 0;
    for (let i = 0; i < str.length; i++) {
        hash = str.charCodeAt(i) + ((hash << 5) - hash);
    }
    return `hsl(${hash % 360}, 70%, 45%)`; // Color vibrante pero legible
}

sendBtn.onclick = () => {
    if (msgInput.value.trim() !== "") {
        const user = userInput.value || "Anónimo";
        // Enviamos un objeto con nombre y mensaje por separado
        socket.send({ name: user, text: msgInput.value });
        msgInput.value = '';
    }
};

socket.on('message', (data) => {
    const p = document.createElement('p');
    const color = stringToColor(data.name);
    
    // Creamos una estructura interna con el nombre en negrita y su color
    p.innerHTML = `<strong style="color: ${color}">${data.name}:</strong> ${data.text}`;
    
    const msgContainer = document.getElementById('messages');
    msgContainer.appendChild(p);
    
    // Auto-scroll al último mensaje
    msgContainer.scrollTop = msgContainer.scrollHeight;
});



